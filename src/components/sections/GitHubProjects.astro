---
import Card from '../Card.astro';
import { Github } from 'lucide-react';

// Función para obtener los repositorios de GitHub
async function getGithubProjects() {
    try {
        const response = await fetch('https://api.github.com/users/EdwinFlores19/repos?sort=updated&direction=desc');
        if (!response.ok) {
            return [];
        }
        const repos = await response.json();
        
        // Filtrar y mapear los repositorios que quieres mostrar
        const projectNamesToShow = [
            "Portafolio-Edwin-Flores-2025",
            "Analisis-Estadistico-House-Prices-Streamlit",
            "API-REST-ProyectoDBP-TIENDA",
            "SAP-UI5-16072025",
            "billar-python-20072025",
            "Creador-de-Cuestionarios-y-Preguntas-Competencia-de-Kahoot"
        ];

        return repos
            .filter(repo => projectNamesToShow.includes(repo.name))
            .map(repo => ({
                title: repo.name.replaceAll('-', ' ').replace('Portafolio Edwin Flores 2025', 'Portafolio de Proyectos'),
                description: repo.description || 'Un proyecto destacado que muestra mis habilidades en desarrollo de software.',
                link: repo.html_url,
                stars: repo.stargazers_count,
                forks: repo.forks_count
            }));
    } catch (error) {
        console.error("Error fetching GitHub projects:", error);
        return []; // Devuelve un array vacío si hay un error
    }
}

const projects = await getGithubProjects();
---
<section id="github-projects" class="py-24">
    <h2 class="text-4xl font-bold mb-12 text-center">Mis Proyectos en GitHub</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {projects.map(project => (
            <a href={project.link} target="_blank" rel="noopener noreferrer" class="block hover:scale-105 transition-transform duration-300">
                <Card>
                    <div class="flex justify-between items-start">
                        <Github className="text-primary mb-4" size={36}/>
                        <div class="text-right">
                            <p class="text-sm font-semibold text-text-secondary">⭐ {project.stars}</p>
                            <p class="text-sm font-semibold text-text-secondary"> Forks: {project.forks}</p>
                        </div>
                    </div>
                    <h3 class="text-xl font-bold mb-2">{project.title}</h3>
                    <p class="text-text-secondary">{project.description}</p>
                </Card>
            </a>
        ))}
    </div>
    <div class="text-center mt-12">
        <a href="https://github.com/EdwinFlores19" target="_blank" rel="noopener noreferrer"
           class="inline-block bg-primary text-white font-semibold py-3 px-8 rounded-lg hover:bg-primary/80 transition-transform duration-300 hover:scale-105 text-lg">
           Ver más en GitHub
        </a>
    </div>
</section>